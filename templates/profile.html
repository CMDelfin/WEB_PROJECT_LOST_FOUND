{% extends 'base.html' %}

{% block content %}
<div class="container py-4">

    <h2 class="mb-4 text-center text-md-start">Your Profile</h2>

    <form action="{{ url_for('profile') }}" method="POST" enctype="multipart/form-data" class="profile-form">

        <div class="d-flex flex-column align-items-center align-items-md-start mb-4">
            {% if current_user.profile_pic %}
                <img src="{{ url_for('static', filename='uploads/' + current_user.profile_pic) }}"
                     alt="Profile Picture"
                     class="rounded-circle profile-pic">
            {% else %}
                <img src="{{ url_for('static', filename='default_profile.png') }}"
                     alt="Profile Picture"
                     class="rounded-circle profile-pic">
            {% endif %}
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Change Profile Picture</label>
            <input type="file" class="form-control" name="profile_pic" accept="image/*">
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Username</label>
            <input type="text" class="form-control" name="username"
                   value="{{ current_user.username }}" required>
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Email</label>
            <input type="email" class="form-control" name="email"
                   value="{{ current_user.email }}" required>
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Phone</label>
            <input type="text" class="form-control" name="phone"
                   value="{{ current_user.phone }}">
        </div>

        <div class="d-flex flex-column flex-md-row justify-content-between mt-3 gap-2">
            <button type="submit" class="btn btn-primary w-100 w-md-auto">
                Update Profile
            </button>

            <button type="button" class="btn btn-danger w-100 w-md-auto"
                    data-bs-toggle="modal" data-bs-target="#deleteModal">
                Delete Account
            </button>
        </div>
    </form>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1">
  <div class="modal-dialog">
      <form action="{{ url_for('delete_account') }}" method="POST">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title">Confirm Delete</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>

              <div class="modal-body">
                  Are you sure you want to delete your account?
                  <strong>This action cannot be undone.</strong>
              </div>

              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <button type="submit" class="btn btn-danger">Delete Account</button>
              </div>
          </div>
      </form>
  </div>
</div>

{% endblock %}
